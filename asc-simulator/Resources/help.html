<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="github.css" type="text/css" />
</head>
<body>
<h1 id="asc-simulator">ASC Simulatorの使い方</h1>
<hr />
<h1>目次</h1>
<ol>
<li><a href="#1-画面の説明">画面の説明</a></li>
<li><p><a href="#2-機能の説明">機能の説明</a></p>
<ol>
<li><a href="#2-1-メニューバー">メニューバー</a></li>
<li><a href="#2-2-マシンビュー">マシンビュー</a></li>
<li><a href="#2-3-メモリレジスタ">メモリ、レジスタ</a></li>
<li><a href="#2-4-ツールバー">ツールバー</a></li>
</ol></li>
<li><p><a href="#3-基本的な使い方">基本的な使い方</a></p>
<ol>
<li><a href="#3-1-自分で作ったプログラムを実行する">自分で作ったプログラムを実行する</a></li>
<li><a href="#3-2-デバッグする">デバッグする</a></li>
<li><a href="#3-3-シミュレータ上でプログラムを作成する">シミュレータ上でプログラムを作成する</a></li>
</ol></li>
<li><p><a href="#4-注意点">注意点</a></p></li>
</ol>
<hr />
<p><span id="1-画面の説明"></span></p>
<h1>1. 画面の説明</h1>
<p><img src="help/画面.png" alt="画面" /></p>
<p><a href="#2-機能の説明">2. 機能の説明</a>にて、各部の詳しい説明をします。</p>
<p><span id="2-機能の説明"></span></p>
<h1>2. 機能の説明</h1>
<p><span id="2-1-メニューバー"></span></p>
<h2>2-1. メニューバー</h2>
<p><span id="ファイル"></span></p>
<h2>ファイル</h2>
<p><img src="help/ファイル.png" alt="ファイル" /></p>
<p><span id="ファイルを開く"></span></p>
<h4>[ファイルを開く]</h4>
<p>asc-assembler.exeやasc-simulator.exeの出力した.ascoファイルを選択し、メモリに読み込みます。</p>
<p>またこの時、.ascsファイルで設定したORGの値がPCに設定されます。</p>
<p><span id="ファイルを書き出す"></span></p>
<h4>[ファイルへ書き出す]</h4>
<p>MMの内容を.ascoファイルへ書き出します。</p>
<p>ここで書き出すファイルは、asc-assembler.exeの書き出すファイルと互換性があります。</p>
<p><span id="環境設定"></span></p>
<h4>[環境設定]</h4>
<p>マシンビューの設定など、細かな設定をすることができます。</p>
<p><span id="動作"></span></p>
<h2>動作</h2>
<p><img src="help/動作.png" alt="動作" /></p>
<p><span id="レジスタとフラグを初期化"></span></p>
<h4>[レジスタとフラグを初期化]</h4>
<p>レジスタ、フラグの値を0に設定します。</p>
<p>後述する<a href="#初期化">[初期化ボタン]<img src="help/初期化ボタン.png" alt="初期化" /></a>との違いは、命令サイクルの状態を変更しないことです。</p>
<p><span id="メモリを初期化"></span></p>
<h4>[メモリを初期化]</h4>
<p>メモリの内容を0で初期化します。</p>
<p><span id="ブレークポイントを初期化"></span></p>
<h4>[ブレークポイントを初期化]</h4>
<p>ブレークポイントを全て解除します。</p>
<p><span id="表示を更新"></span></p>
<h4>[表示を更新]</h4>
<p>マシンビューの表示、MMの表示、レジスタの表示を更新します。<br />表示に不具合のある場合などに使用してください。</p>
<p><span id="指定アドレスへ移動"></span></p>
<h4>[指定アドレスへ移動]</h4>
<p>押すと、以下のようなダイアログが表示されます。</p>
<p><img src="help/指定アドレスへ移動.png" alt="指定アドレスへ移動" /></p>
<p>表示したいアドレスを入力し、<strong>[移動]</strong>を押すことで、MMの表示を指定したアドレスまでスクロールすることができます。</p>
<p><span id="ヘルプ"></span></p>
<h2>ヘルプ</h2>
<p><img src="help/ヘルプ.png" alt="ヘルプ" /></p>
<h3>[使い方]</h3>
<p>このページを表示します。</p>
<p><span id="このプログラムについて"></span></p>
<h3>[このプログラムについて]</h3>
<p>プログラムのバージョンなどを確認することができます。</p>
<p><span id="2-2-マシンビュー"></span></p>
<h2>2-2. マシンビュー</h2>
<p>ASCマシンの状態を確認することができます。</p>
<p><img src="help/マシンビュー.png" alt="マシンビュー" /></p>
<p><span id="色について"></span></p>
<h3>色について</h3>
<p>マシンビューにおいて、値の書き換え、値の参照などが発生した場合、色が変わることがあります。</p>
<p><strong>緑色</strong>はその部分において、<strong>参照が発生</strong>したことを表しています。</p>
<p><img src="help/参照.png" alt="参照" /></p>
<p><strong>オレンジ色</strong>は<strong>書き換えが発生</strong>したことを表しています。</p>
<p><img src="help/書き換え.png" alt="書き換え" /></p>
<p>また、色のついた矢印は、<strong>値が移動したこと</strong>を表しています。</p>
<p><span id="2-3-メモリレジスタ"></span></p>
<h2>2-3. メモリ、レジスタ</h2>
<p><span id="MMビューの見方"></span></p>
<h3 id="mm">MMビューの見方</h3>
<p>画面右の<strong>[MM]</strong>という表に、ASCマシンのMMの内容が表示されます。</p>
<p><img src="help/MM.png" alt="MMビュー" /></p>
<p>MMビューには<strong>アドレス</strong>、<strong>バイナリ</strong>、<strong>ニーモニック</strong>の順に値が表示されており、</p>
<p><strong>バイナリ</strong>列にはMMの内容の<strong>二進数表示</strong>が、<br /><strong>ニーモニック</strong>列にはMMの内容の<strong>逆アセンブル</strong>が表示されています。</p>
<p><em>(ただし、ここで表示されている<strong>ニーモニック</strong>はあくまでもMMの逆アセンブルです。<br /> .ascsファイルで定数とした値も、<br /> シミュレータ上では命令として解釈され表示されることに注意してください。)</em></p>
<p><span id="MMビューの色について"></span></p>
<h3 id="mm">MMビューの色について</h3>
<p>MMビューの行が着色されるときがあります。</p>
<p><img src="help/MMビュー色.png" alt="MMビューの色" /></p>
<p><strong>濃い赤</strong>は<strong>現在実行している命令の内容</strong>を表しており、</p>
<p><strong>薄い赤</strong>は<strong>PCの指すアドレスの命令の内容</strong>を表しています。</p>
<p><span id="MMの内容を変更する"></span></p>
<h3 id="mm">MMの内容を変更する</h3>
<p><strong>バイナリ</strong>、<strong>ニーモニック</strong>の列は、クリックすることで直接書き換えることができます。</p>
<p>値を入力した後、<strong>Enterを押すか、他の行をクリックすること</strong>でMMへ反映することができます。</p>
<p>書式にエラーがあった場合は、<strong>赤い<img src="help/赤いマーク.png" alt="赤いマーク" /></strong>マークが表示されます。</p>
<p>この<strong>赤い<img src="help/赤いマーク.png" alt="赤いマーク" /></strong>マークにマウスオーバーすることでエラーの内容を確認することができます。<br /><img src="help/MMエラー.png" alt="MMエラー" /></p>
<p><span id="ブレークポイントを設定する"></span></p>
<h3>ブレークポイントを設定する</h3>
<p><strong>[MM]</strong>のアドレスの左にある列をクリックすることで、<strong>ブレークポイント</strong>を設定できます。</p>
<p><img src="help/ブレークポイント.png" alt="ブレークポイント" /></p>
<p>ブレークポイントとは、<a href="#3-2-デバッグする">デバッグ</a>の際などに、指定したアドレスで自動的に実行を停止する機能です。</p>
<p>ブレークポイントが設定されたアドレスは、左側に<strong>赤い丸<img src="help/赤い丸.png" alt="赤い丸" /></strong>が表示されます。</p>
<p>この<strong>赤い丸<img src="help/赤い丸.png" alt="赤い丸" /></strong>をもう一度クリックすることで、ブレークポイントを解除することができます。</p>
<p>また、メニューバーより<strong>[動作]→[ブレークポイントを初期化]</strong>機能より、全てのブレークポイントを解除することもできます。→<em><a href="#ブレークポイントを初期化">ブレークポイントを初期化</a></em></p>
<hr />
<p><span id="レジスタビューの見方"></span></p>
<h3>レジスタビューの見方</h3>
<p>画面右下に表示されている<strong>[レジスタ]</strong>という表に、レジスタとフラグの値が表示されます。</p>
<p><img src="help/レジスタ.png" alt="レジスタ" /></p>
<p><strong>名前</strong>、<strong>値</strong>の列にそれぞれ、<strong>レジスタ名</strong>と<strong>レジスタの値</strong>が表示されています。</p>
<p><span id="レジスタの内容を変更する"></span></p>
<h3>レジスタの内容を変更する</h3>
<p><strong>値</strong>列はクリックすることで編集することができます。</p>
<p><strong>Enterを押すことや、他の行をクリックすること</strong>で編集内容をレジスタに反映することができます。</p>
<p>入力にエラーがあった場合は、<strong>赤い<img src="help/赤いマーク.png" alt="赤いマーク" /></strong>マークが表示されます。</p>
<p>この<strong>赤い<img src="help/赤いマーク.png" alt="赤いマーク" /></strong>マークにマウスオーバーすることでエラーの内容を確認することができます。</p>
<p><img src="help/レジスタエラー.png" alt="レジスタエラー" /></p>
<p><span id="2-4-ツールバー"></span></p>
<h2>2-4. ツールバー</h2>
<p>画面下部のツールバーには、ASCマシンの動作を操作するボタンなどが配置されています。</p>
<p><img src="help/ツールバー.png" alt="ツールバー" /></p>
<p><span id="初期化"></span></p>
<h3>初期化</h3>
<p><img src="help/初期化ボタン.png" alt="初期化" /></p>
<p>ASCマシンの<strong>レジスタとフラグの値を0に設定</strong>し、<strong>命令サイクルの冒頭に戻ります。</strong></p>
<p>メニューバーにある、<a href="#レジスタとフラグを初期化">[レジスタとフラグを初期化]</a>との違いは、<br />命令サイクルを冒頭に戻す機能が追加されていることです。</p>
<p>プログラムを実行しなおす際などには、基本的にはこちらを使用してください。</p>
<p><span id="通常実行"></span></p>
<h3>通常実行</h3>
<p><img src="help/通常実行ボタン.png" alt="通常実行" /></p>
<p>ASCマシンを、<strong>HLT命令</strong>か<strong>ブレークポイント</strong>があわられるまで実行します。</p>
<p>手動で停止する際は、後述する<strong><a href="#ブレーク">[ブレーク]</a>ボタン<img src="help/ブレークボタン.png" /></strong>を使用してください。</p>
<p><span id="命令単位ステップラン"></span></p>
<h3>命令単位ステップラン</h3>
<p><img src="help/命令単位ステップランボタン.png" alt="命令単位ステップラン" /></p>
<p>ASCマシンを、<strong>次の命令まで実行して停止します。</strong></p>
<p><span id="状態単位ステップラン"></span></p>
<h3>状態単位ステップラン</h3>
<p><img src="help/状態単位ステップランボタン.png" alt="状態単位ステップラン" /></p>
<p>ASCマシンを、<strong>次の状態まで実行して停止します。</strong></p>
<p><span id="ブレーク"></span></p>
<h3>ブレーク</h3>
<p><img src="help/ブレークボタン.png" alt="ブレーク" /></p>
<p>ASCマシンを、<strong>現在の状態で停止します。</strong></p>
<p>HLT命令で停止している際も、一度このボタンを押してから各種操作をするようにしてください。</p>
<hr />
<p><span id="実行速度コントローラ"></span></p>
<h3>実行速度コントローラ</h3>
<p><img src="help/実行速度コントローラ.png" alt="実行速度コントローラ" /></p>
<p>スライダを調節することで、<strong>[通常実行]ボタン<img src="help/通常実行ボタン.png" alt="通常実行" /></strong>を押した際の<strong>ASCマシンの実行速度を調節できます。</strong></p>
<p>実行速度を遅くすることで、処理の内容を追いやすくなります。</p>
<p>また、処理に時間のかかるプログラムなどは、実行速度を速めることで高速に実行することができます。</p>
<p><span id="3-基本的な使い方"></span></p>
<h1>3. 基本的な使い方</h1>
<p><span id="3-1-自分で作ったプログラムを実行する"></span></p>
<h2>3-1. 自分で作ったプログラムを実行する</h2>
<p>このシミュレータは、同封のasc-assembler.exeの出力する、.ascoファイルを読み込むことができます。</p>
<p>以下に、このシミュレータを使ってプログラムを実行する手順を示します。</p>
<ol>
<li><strong>[初期化]ボタン</strong><img src="help/初期化ボタン.png" alt="初期化" />を押す。</li>
<li>メニューバーより、<strong>[ファイル]</strong>→<strong>[ファイルを開く]</strong>を押す。</li>
<li>読み込みたいファイルを選択し、<strong>[開く]</strong>を押す。</li>
<li>画面下部のステータスバーで、読み込みの成功を確認する。</li>
<li><strong>[通常実行]</strong>ボタン<img src="help/通常実行ボタン.png" alt="通常実行" />を押す。</li>
</ol>
<p>以上の手順で、プログラムを実行することができます。</p>
<p><strong>(2, 3の手順を、ファイルをドラッグ&amp;ドロップすることによって代用することもできます。)</strong></p>
<p><span id="3-2-デバッグする"></span></p>
<h2>3-2. デバッグする</h2>
<p>読み込んだプログラムをデバッグするための手順を、以下に示します。</p>
<ol>
<li>動作を確認したいアドレスに、ブレークポイントを設定する。→<br /><em><a href="#ブレークポイントを設定する">ブレークポイントを設定する</a></em></li>
<li><strong>[通常実行]ボタン<img src="help/通常実行ボタン.png" alt="通常実行" /></strong>を押す。</li>
<li>ブレークポイントで停止するので、<strong>[命令単位ステップラン]ボタン<img src="help/命令単位ステップランボタン.png" alt="命令単位" /></strong>や<br /><strong>[状態単位ステップラン]ボタン<img src="help/状態単位ステップランボタン.png" alt="状態単位" /></strong>を使い、動作を確認する。</li>
<li>バグを確認したら、MMの該当のアドレスを書き換える。→ <em><a href="#MMの内容を変更する">MMの内容を変更する</a></em></li>
<li><strong>[初期化]ボタン<img src="help/初期化ボタン.png" alt="初期化" /></strong>を押して、レジスタとフラグを初期化する。</li>
<li>PCの値をプログラムの初期位置に変更し、手順2へ戻る。→ <em><a href="#レジスタの内容を変更する">レジスタの内容を変更する</a></em></li>
</ol>
<p>バグの改善が確認できるまで、この操作を繰り返してください。</p>
<p>ブレークポイントで停止している間に、RやZ, Nなどの値を変更することも、バグの特定につながります。</p>
<p><span id="3-3-シミュレータ上でプログラムを作成する"></span></p>
<h2>3-3. シミュレータ上でプログラムを作成する</h2>
<p><a href="#MMの内容を変更する">MMの変更機能</a>により、シミュレータ上でプログラムを作成することも可能です。</p>
<p>以下に、その手順を示します。</p>
<ol>
<li>MMが初期化されていることを確認する。→ <em><a href="#メモリを初期化">メモリを初期化</a></em></li>
<li>MMの内容を書き換え、プログラムを作成する。→ <em><a href="#MMの内容を変更する">MMの内容を変更する</a></em></li>
<li>PCの値をプログラムの開始位置に設定する。→ <em><a href="#レジスタの内容を変更する">レジスタの内容を変更する</a></em></li>
<li><strong>[通常実行]ボタン<img src="help/通常実行ボタン.png" alt="通常実行" /></strong>を押し、動作を確認する。</li>
<li>デバッグをする。→ <em><a href="#3-2-デバッグする">3-2. デバッグする</a></em></li>
<li>メニューバーより、<strong>[ファイル]</strong>→<strong>[ファイルへ書き出す]</strong>を押し、プログラムを保存する。</li>
</ol>
<p>ここで書き出した.ascoファイルは、asc-assembler.exeの出力するファイルと互換性があるため、再びシミューレータで読み込むことができます。</p>
<p><span id="4-注意点"></span></p>
<h1>4. 注意点</h1>
<ul>
<li>メモリの内容を書き出す際、0番地から書き出されます。</li>
<li>メモリの内容を書き出したファイルのサイズは、変更されているメモリの最後の番地の、<br />次の2の倍数byteになります。(例えば、メモリの使用が0xF0〜0xFF番地までの場合、128byteになります)</li>
<li>実行中は、メモリ、レジスタの値は変更することができません。</li>
<li>HLT命令でASCマシンが停止した場合も、ブレークボタンを押すまで操作はできません。</li>
<li>ADD、SUB命令によりオーバフローが発生した場合、マシンはブレークし、「オーバフローが発生しています」と表示します。</li>
</ul>
</body>
</html>
